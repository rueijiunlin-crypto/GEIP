<!-- partials/navbar.html (with centered nav + site search) -->
<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container-fluid">
    <!-- å·¦ï¼šå“ç‰Œ -->
    <a class="navbar-brand" href="index.html">
      <img src="image/logo.png" alt="logo"> ç¶ è‰²å·¥ç¨‹å­¸ç¨‹
    </a>

    <!-- æ‰‹æ©Ÿ/å¹³æ¿ï¼šé–‹å•Ÿå´é‚Šå°è¦½ -->
    <button class="navbar-toggler d-lg-none" type="button"
            data-bs-toggle="offcanvas" data-bs-target="#mobileNav"
            aria-controls="mobileNav" aria-label="é–‹å•Ÿå°è¦½">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- æ¡Œæ©Ÿï¼šå°è¦½ç½®ä¸­ + å³å´æœå°‹ -->
    <div class="collapse navbar-collapse" id="navbarNav">
      <!-- âœ… å°è¦½ç½®ä¸­ -->
      <ul class="navbar-nav mx-auto">
        <!-- è¨ˆç•«ç°¡ä»‹ -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">è¨ˆç•«ç°¡ä»‹</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="origin.html">è¨ˆç•«ç·£èµ·</a></li>
            <li><a class="dropdown-item" href="goal.html">è¨ˆç•«ç›®æ¨™</a></li>
            <li><a class="dropdown-item" href="faculty.html">å¸«è³‡ä»‹ç´¹</a></li>
          </ul>
        </li>

        <!-- è¨Šæ¯å…¬å‘Š -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">è¨Šæ¯å…¬å‘Š</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="news.html">æœ€æ–°æ¶ˆæ¯</a></li>
          </ul>
        </li>

        <!-- å­¸ç¨‹è³‡è¨Š -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">å­¸ç¨‹è³‡è¨Š</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="rules.html">ä¿®èª²è¦ç¯„</a></li>
            <li><a class="dropdown-item" href="curriculum.html">èª²ç¨‹è¦åŠƒè¡¨</a></li>
            <li><a class="dropdown-item" href="apply.html">ç”³è«‹æµç¨‹èˆ‡è¡¨å–®</a></li>
            <li><a class="dropdown-item" href="certificate.html">å­¸ç¨‹è­‰æ›¸èªªæ˜</a></li>
          </ul>
        </li>

        <!-- è·¨é ˜åŸŸå¯¦å‹™å°ˆé¡Œ -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">è·¨é ˜åŸŸå¯¦å‹™å°ˆé¡Œ</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="cross_discipline.html">ä¿®èª²è¦å®š</a></li>
            <li><a class="dropdown-item" href="partners.html">åˆä½œä¼æ¥­</a></li>
            <li><a class="dropdown-item" href="project_showcase.html">å°ˆé¡Œæˆæœå±•ç¤º</a></li>
          </ul>
        </li>

        <!-- å¯¦ç¿’å°ˆå€ -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">å¯¦ç¿’å°ˆå€</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="internship_rules.html">ä¿®èª²è¦å®š</a></li>
            <li><a class="dropdown-item" href="internship_partners.html">åˆä½œä¼æ¥­</a></li>
            <li><a class="dropdown-item" href="intern_experience.html">å¯¦ç¿’ç¶“é©—åˆ†äº«</a></li>
          </ul>
        </li>

        <!-- æ•™å­¸è³‡æº -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">æ•™å­¸è³‡æº</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="videos.html">ç‰¹è‰²å–®å…ƒå½±ç‰‡</a></li>
            <li><a class="dropdown-item" href="materials.html">èª²ç¨‹æ•™æä¸‹è¼‰å€</a></li>
          </ul>
        </li>

        <!-- äº’å‹•äº¤æµ -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">äº’å‹•äº¤æµ</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="contact.html">è¯çµ¡æˆ‘å€‘</a></li>
            <li><a class="dropdown-item" href="faq.html">å¸¸è¦‹å•ç­”</a></li>
            <li><a class="dropdown-item" href="links.html">ç›¸é—œç¶²ç«™</a></li>
            <li><a class="dropdown-item" href="gallery.html">æ´»å‹•èŠ±çµ®</a></li>
          </ul>
        </li>
      </ul>

      <!-- âœ… æ¡Œæ©Ÿï¼šå³å´æœå°‹ -->
      <form class="d-none d-lg-flex search-box" id="siteSearchForm" role="search">
        <input class="form-control form-control-sm" id="siteSearchInput" type="search" placeholder="ç«™å…§æœå°‹â€¦" aria-label="ç«™å…§æœå°‹">
        <button class="btn btn-light btn-sm ms-2" type="submit">æœå°‹</button>
      </form>
    </div>
  </div>
</nav>

<!-- æ‰‹æ©Ÿ/å¹³æ¿ï¼šå´é‚Šå…¨ç‰ˆå°è¦½ -->
<div class="offcanvas offcanvas-start text-bg-dark" tabindex="-1" id="mobileNav" aria-labelledby="mobileNavLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title d-flex align-items-center gap-2" id="mobileNavLabel">
      <img src="image/logo.png" alt="" style="height:28px"> ç¶ è‰²å·¥ç¨‹å­¸ç¨‹
    </h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="é—œé–‰"></button>
  </div>

  <div class="offcanvas-body">
    <!-- âœ… è¡Œå‹•ç‰ˆæœå°‹ -->
    <form class="input-group mb-3" id="siteSearchFormMobile" role="search">
      <input class="form-control" id="siteSearchInputMobile" type="search" placeholder="ç«™å…§æœå°‹â€¦" aria-label="ç«™å…§æœå°‹">
      <button class="btn btn-light" type="submit">æœå°‹</button>
    </form>

    <div class="list-group list-group-flush">
      <a class="list-group-item list-group-item-action list-group-item-dark" href="index.html">é¦–é </a>

      <button class="list-group-item list-group-item-action list-group-item-dark d-flex justify-content-between align-items-center"
              data-bs-toggle="collapse" data-bs-target="#m-plan" aria-expanded="false">
        è¨ˆç•«ç°¡ä»‹ <span class="ms-2">â–¾</span>
      </button>
      <div id="m-plan" class="collapse">
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="origin.html">è¨ˆç•«ç·£èµ·</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="goal.html">è¨ˆç•«ç›®æ¨™</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="faculty.html">å¸«è³‡ä»‹ç´¹</a>
      </div>

      <button class="list-group-item list-group-item-action list-group-item-dark d-flex justify-content-between align-items-center"
              data-bs-toggle="collapse" data-bs-target="#m-news">
        è¨Šæ¯å…¬å‘Š <span class="ms-2">â–¾</span>
      </button>
      <div id="m-news" class="collapse">
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="news.html">æœ€æ–°æ¶ˆæ¯</a>
      </div>

      <button class="list-group-item list-group-item-action list-group-item-dark d-flex justify-content-between align-items-center"
              data-bs-toggle="collapse" data-bs-target="#m-info">
        å­¸ç¨‹è³‡è¨Š <span class="ms-2">â–¾</span>
      </button>
      <div id="m-info" class="collapse">
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="rules.html">ä¿®èª²è¦ç¯„</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="curriculum.html">èª²ç¨‹è¦åŠƒè¡¨</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="apply.html">ç”³è«‹æµç¨‹èˆ‡è¡¨å–®</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="certificate.html">å­¸ç¨‹è­‰æ›¸èªªæ˜</a>
      </div>

      <button class="list-group-item list-group-item-action list-group-item-dark d-flex justify-content-between align-items-center"
              data-bs-toggle="collapse" data-bs-target="#m-cross">
        è·¨é ˜åŸŸå¯¦å‹™å°ˆé¡Œ <span class="ms-2">â–¾</span>
      </button>
      <div id="m-cross" class="collapse">
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="cross_discipline.html">ä¿®èª²è¦å®š</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="partners.html">åˆä½œä¼æ¥­</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="project_showcase.html">å°ˆé¡Œæˆæœå±•ç¤º</a>
      </div>

      <button class="list-group-item list-group-item-action list-group-item-dark d-flex justify-content-between align-items-center"
              data-bs-toggle="collapse" data-bs-target="#m-intern">
        å¯¦ç¿’å°ˆå€ <span class="ms-2">â–¾</span>
      </button>
      <div id="m-intern" class="collapse">
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="internship_rules.html">ä¿®èª²è¦å®š</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="internship_partners.html">åˆä½œä¼æ¥­</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="intern_experience.html">å¯¦ç¿’ç¶“é©—åˆ†äº«</a>
      </div>

      <button class="list-group-item list-group-item-action list-group-item-dark d-flex justify-content-between align-items-center"
              data-bs-toggle="collapse" data-bs-target="#m-teach">
        æ•™å­¸è³‡æº <span class="ms-2">â–¾</span>
      </button>
      <div id="m-teach" class="collapse">
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="videos.html">ç‰¹è‰²å–®å…ƒå½±ç‰‡</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="materials.html">èª²ç¨‹æ•™æä¸‹è¼‰å€</a>
      </div>

      <button class="list-group-item list-group-item-action list-group-item-dark d-flex justify-content-between align-items-center"
              data-bs-toggle="collapse" data-bs-target="#m-interact">
        äº’å‹•äº¤æµ <span class="ms-2">â–¾</span>
      </button>
      <div id="m-interact" class="collapse">
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="contact.html">è¯çµ¡æˆ‘å€‘</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="faq.html">å¸¸è¦‹å•ç­”</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="links.html">ç›¸é—œç¶²ç«™</a>
        <a class="list-group-item list-group-item-action list-group-item-dark ps-4" href="gallery.html">æ´»å‹•èŠ±çµ®</a>
      </div>
    </div>
  </div>
</div>

<!-- ğŸ” æœå°‹çµæœ Modal -->
<div class="modal fade" id="searchResultsModal" tabindex="-1" aria-labelledby="searchResultsLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="searchResultsLabel">æœå°‹çµæœ</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="é—œé–‰"></button>
      </div>
      <div class="modal-body" id="searchResultsBody">
        <!-- çµæœç”± JS æ³¨å…¥ -->
      </div>
    </div>
  </div>
</div>

<script>
  // æ‰‹æ©Ÿï¼šé»äº† offcanvas è£¡çš„é€£çµå°±è‡ªå‹•æ”¶èµ·
  document.addEventListener('click', function (e) {
    const a = e.target.closest('#mobileNav a[href]');
    if (!a) return;
    const el = document.getElementById('mobileNav');
    const inst = window.bootstrap?.Offcanvas.getInstance(el);
    inst && inst.hide();
  });

  // ===== ç«™å…§æœå°‹ï¼ˆç´”å‰ç«¯ã€æ¯”å° search_index.json çš„ title/keywordsï¼‰ =====
  (function () {
    const INDEX_URL = 'js/search_index.json'; // æ”¾åœ¨ç¶²ç«™æ ¹ç›®éŒ„
    let indexData = [];
    fetch(INDEX_URL).then(r => r.json()).then(d => { indexData = d; });

    const formDesktop = document.getElementById('siteSearchForm');
    const inputDesktop = document.getElementById('siteSearchInput');
    const formMobile  = document.getElementById('siteSearchFormMobile');
    const inputMobile = document.getElementById('siteSearchInputMobile');

    const modalEl = document.getElementById('searchResultsModal');
    const modalBody = document.getElementById('searchResultsBody');

    function openResults(results, q) {
      if (!modalEl) return;
      let html = '';
      if (!results.length) {
        html = `<p class="text-muted mb-0">æ‰¾ä¸åˆ°èˆ‡ã€Œ<strong>${q}</strong>ã€ç›¸é—œçš„å…§å®¹ã€‚</p>`;
      } else {
        html = `<p class="text-muted">å…± ${results.length} ç­†çµæœï¼š</p><div class="list-group">` +
          results.map(it => `
            <a href="${it.url}" class="list-group-item list-group-item-action">
              <div class="fw-bold">${it.title}</div>
              <small class="text-muted">${it.keywords || ''}</small>
            </a>
          `).join('') +
          `</div>`;
      }
      modalBody.innerHTML = html;
      const m = new bootstrap.Modal(modalEl);
      m.show();
    }

    function doSearch(q) {
      q = (q || '').trim();
      if (!q || !indexData.length) return;
      const lc = q.toLowerCase();
      const res = indexData.filter(it =>
        (it.title && it.title.toLowerCase().includes(lc)) ||
        (it.keywords && it.keywords.toLowerCase().includes(lc))
      );
      openResults(res, q);
    }

    formDesktop && formDesktop.addEventListener('submit', function (e) {
      e.preventDefault();
      doSearch(inputDesktop.value);
    });
    formMobile && formMobile.addEventListener('submit', function (e) {
      e.preventDefault();
      doSearch(inputMobile.value);
    });
  })();
</script>
